{"changed":true,"filter":false,"title":"report_view_monthly_customers.html.erb","tooltip":"/app/views/reports/report_view_monthly_customers.html.erb","value":"<%= render 'layouts/charts' %>\n<%\ninvoices_subtotal = 0\ninvoices_tax = 0\ninvoices_total = 0\nsubtotals = []\ntaxes = []\ntotals = []\n%>\n<div class=\"breadcrumbs\">\n  \n  \n  <%= link_to \"Monthly customers reports\", \"/companies/reports/monthly_customers/#{@company.id}\" %>\n</div>\n\n<h1>\n  <%= image_tag(\"reports_48.png\", :class => \"vmiddle\") %>\n  Monthly customers report - <%= @customer.name %> - <%= @month_name %> <%= @year %>\n</h1>\n\n<form method=\"get\" action=\"/companies/reports/view_monthly_customers/<%= @company.id %>/<%= @customer.id %>\">\n  <%= select_tag(:year, options_for_select(@years, @year)) %>\n  <%= select_tag(:month, options_for_select(@months, @month)) %>\n  <input type=\"submit\" value=\"View report\" class=\"small_btn\" />\n  <a href=\"/companies/reports/view_monthly_customers/<%= @company.id %>/<%= @customer.id %>\" class=\"small_btn\">Today</a>\n</form>\n\n<br />\n\n<div id=\"container_chart\" class=\"chart\"></div>\n\n<table>\n  <thead>\n    <tr>\n      <th class=\"bordered_bottom bordered_right\" style=\"width: 70px;\">\n        Date\n      </th>\n      <th class=\"bordered_bottom bordered_right\" style=\"width: 100px;\">\n        Subtotal\n      </th>\n      <th class=\"bordered_bottom bordered_right\" style=\"width: 100px;\">\n        Tax\n      </th>\n      <th class=\"bordered_bottom bordered_right\" style=\"width: 100px;\">\n        Total\n      </th>\n    </tr>\n  </thead>\n  <tbody>\n    <% for date in @dates %>\n      <tr>\n        <td class=\"bordered_bottom bordered_right\">\n          <%= doDate(Time.parse(\"#{date}-01\"), 5) %>\n        </td>\n        <td class=\"bordered_bottom bordered_right right\">\n          <%\n          subtotal = @company.get_invoices_value_customer_date(@customer, date, \"subtotal\")\n          subtotals.push(subtotal)\n          invoices_subtotal += subtotal\n          %>\n          $<%= money(subtotal) %>\n        </td>\n        <td class=\"bordered_bottom bordered_right right\">\n          <%\n            tax = @company.get_invoices_value_customer_date(@customer, date, \"tax\")\n          taxes.push(tax)\n          invoices_tax += tax\n          %>\n          $<%= money(tax) %>\n        </td>\n        <td class=\"bordered_bottom bordered_right right\">\n          <%\n          total = @company.get_invoices_value_customer_date(@customer, date, \"total\")\n          totals.push(total)\n          invoices_total += total\n          %>\n          $<%= money(total) %>\n        </td>\n      </tr>\n    <% end %>\n    <tr>\n      <td class=\"bordered_bottom bordered_right bold\">\n        Total:\n      </td>\n      <td class=\"bordered_bottom bordered_right right bold\">\n        $<%= money(invoices_subtotal) %>\n      </td>\n      <td class=\"bordered_bottom bordered_right right bold\">\n        $<%= money(invoices_tax) %>\n      </td>\n      <td class=\"bordered_bottom bordered_right right bold\">\n        $<%= money(invoices_total) %>\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n<br />\n\n<div class=\"button\">\n  <%= link_to \"Back\", \"/companies/reports/#{@company.id}\" %>\n</div>\n\n<script type=\"text/javascript\"> \n$(document).ready(function() {\n\tvar chart = new Highcharts.Chart({\n\t\tchart: {\n\t\t\trenderTo: 'container_chart',\n\t\t\tdefaultSeriesType: 'line',\n\t\t\tmargin: [50, 40, 70, 70]\n\t\t},\n\t\ttitle: {\n\t\t\ttext: 'Monthly customers report',\n\t\t\tstyle: {\n\t\t\t\tmargin: '10px 100px 0 0' // center it\n\t\t\t}\n\t\t},\n\t\tsubtitle: {\n\t\t\ttext: '<%= @customer.name %> - <%= @month_name %> <%= @year %>',\n\t\t\tstyle: {\n\t\t\t\tmargin: '0 100px 0 0' // center it\n\t\t\t}\n\t\t},\n\t\txAxis: {\n\t\t\tcategories: [\n\t\t\t  <%= @date_cats.join(\",\") %>\n\t\t\t],\n\t\t\ttitle: {\n\t\t\t\ttext: 'Month'\n\t\t\t},\n\t\t\tlabels: {\n\t\t\t\trotation: -90, \n\t\t\t\ty: 34, \n\t\t\t\tstyle: {\n\t\t\t\t\tfontSize: '8pt'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tyAxis: {\n\t\t\ttitle: {\n\t\t\t\ttext: 'Sales'\n\t\t\t},\n\t\t\tplotLines: [{\n\t\t\t\tvalue: 0,\n\t\t\t\twidth: 1,\n\t\t\t\tcolor: '#808080'\n\t\t\t}]\n\t\t},\n\t\ttooltip: {\n\t\t\tformatter: function() {\n\t\t\t\treturn '<b>'+ this.series.name +'</b><br/>'+\n\t\t\t\tthis.x +': '+ this.y;\n\t\t\t}\n\t\t},\n\t\tlegend: {\n\t\t\tlayout: 'vertical',\n\t\t\tstyle: {\n\t\t\t\tleft: 'auto',\n\t\t\t\tbottom: 'auto',\n\t\t\t\tright: '10px',\n\t\t\t\ttop: '100px'\n\t\t\t}\n\t\t},\n\t\tcredits: {\n\t\t\tenabled: false\n\t\t},\n\t\tseries: [\n\t\t\t{\n\t\t\t\tname: 'Subtotal',\n\t\t\t\tdata: [\n\t\t\t\t\t<%= subtotals.join(\",\") %>\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'Tax',\n\t\t\t\tdata: [\n\t\t\t\t\t<%= taxes.join(\",\") %>\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'Total',\n\t\t\t\tdata: [\n\t\t\t\t\t<%= totals.join(\",\") %>\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t});\n});\n</script>\n","undoManager":{"mark":3,"position":7,"stack":[[{"start":{"row":0,"column":0},"end":{"row":0,"column":11},"action":"insert","lines":["20505182724"],"id":1}],[{"start":{"row":0,"column":0},"end":{"row":0,"column":11},"action":"remove","lines":["20505182724"],"id":2},{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"insert","lines":["v"]}],[{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"remove","lines":["v"],"id":3}],[{"start":{"row":0,"column":0},"end":{"row":190,"column":0},"action":"insert","lines":["<%= render 'layouts/charts' %>","<%","invoices_subtotal = 0","invoices_tax = 0","invoices_total = 0","subtotals = []","taxes = []","totals = []","%>","<div class=\"breadcrumbs\">","  <%= link_to \"My companies\", \"/companies\" %> &raquo;","  <%= link_to @company.name, @company %> &raquo;","  <%= link_to \"Reports\", \"/companies/reports/#{@company.id}\" %> &raquo;","  <%= link_to \"Monthly customers reports\", \"/companies/reports/monthly_customers/#{@company.id}\" %>","</div>","","<h1>","  <%= image_tag(\"reports_48.png\", :class => \"vmiddle\") %>","  Monthly customers report - <%= @customer.name %> - <%= @month_name %> <%= @year %>","</h1>","","<form method=\"get\" action=\"/companies/reports/view_monthly_customers/<%= @company.id %>/<%= @customer.id %>\">","  <%= select_tag(:year, options_for_select(@years, @year)) %>","  <%= select_tag(:month, options_for_select(@months, @month)) %>","  <input type=\"submit\" value=\"View report\" class=\"small_btn\" />","  <a href=\"/companies/reports/view_monthly_customers/<%= @company.id %>/<%= @customer.id %>\" class=\"small_btn\">Today</a>","</form>","","<br />","","<div id=\"container_chart\" class=\"chart\"></div>","","<table>","  <thead>","    <tr>","      <th class=\"bordered_bottom bordered_right\" style=\"width: 70px;\">","        Date","      </th>","      <th class=\"bordered_bottom bordered_right\" style=\"width: 100px;\">","        Subtotal","      </th>","      <th class=\"bordered_bottom bordered_right\" style=\"width: 100px;\">","        Tax","      </th>","      <th class=\"bordered_bottom bordered_right\" style=\"width: 100px;\">","        Total","      </th>","    </tr>","  </thead>","  <tbody>","    <% for date in @dates %>","      <tr>","        <td class=\"bordered_bottom bordered_right\">","          <%= doDate(Time.parse(\"#{date}-01\"), 5) %>","        </td>","        <td class=\"bordered_bottom bordered_right right\">","          <%","          subtotal = @company.get_invoices_value_customer_date(@customer, date, \"subtotal\")","          subtotals.push(subtotal)","          invoices_subtotal += subtotal","          %>","          $<%= money(subtotal) %>","        </td>","        <td class=\"bordered_bottom bordered_right right\">","          <%","            tax = @company.get_invoices_value_customer_date(@customer, date, \"tax\")","          taxes.push(tax)","          invoices_tax += tax","          %>","          $<%= money(tax) %>","        </td>","        <td class=\"bordered_bottom bordered_right right\">","          <%","          total = @company.get_invoices_value_customer_date(@customer, date, \"total\")","          totals.push(total)","          invoices_total += total","          %>","          $<%= money(total) %>","        </td>","      </tr>","    <% end %>","    <tr>","      <td class=\"bordered_bottom bordered_right bold\">","        Total:","      </td>","      <td class=\"bordered_bottom bordered_right right bold\">","        $<%= money(invoices_subtotal) %>","      </td>","      <td class=\"bordered_bottom bordered_right right bold\">","        $<%= money(invoices_tax) %>","      </td>","      <td class=\"bordered_bottom bordered_right right bold\">","        $<%= money(invoices_total) %>","      </td>","    </tr>","  </tbody>","</table>","","<br />","","<div class=\"button\">","  <%= link_to \"Back\", \"/companies/reports/#{@company.id}\" %>","</div>","","<script type=\"text/javascript\"> ","$(document).ready(function() {","\tvar chart = new Highcharts.Chart({","\t\tchart: {","\t\t\trenderTo: 'container_chart',","\t\t\tdefaultSeriesType: 'line',","\t\t\tmargin: [50, 40, 70, 70]","\t\t},","\t\ttitle: {","\t\t\ttext: 'Monthly customers report',","\t\t\tstyle: {","\t\t\t\tmargin: '10px 100px 0 0' // center it","\t\t\t}","\t\t},","\t\tsubtitle: {","\t\t\ttext: '<%= @customer.name %> - <%= @month_name %> <%= @year %>',","\t\t\tstyle: {","\t\t\t\tmargin: '0 100px 0 0' // center it","\t\t\t}","\t\t},","\t\txAxis: {","\t\t\tcategories: [","\t\t\t  <%= @date_cats.join(\",\") %>","\t\t\t],","\t\t\ttitle: {","\t\t\t\ttext: 'Month'","\t\t\t},","\t\t\tlabels: {","\t\t\t\trotation: -90, ","\t\t\t\ty: 34, ","\t\t\t\tstyle: {","\t\t\t\t\tfontSize: '8pt'","\t\t\t\t}","\t\t\t}","\t\t},","\t\tyAxis: {","\t\t\ttitle: {","\t\t\t\ttext: 'Sales'","\t\t\t},","\t\t\tplotLines: [{","\t\t\t\tvalue: 0,","\t\t\t\twidth: 1,","\t\t\t\tcolor: '#808080'","\t\t\t}]","\t\t},","\t\ttooltip: {","\t\t\tformatter: function() {","\t\t\t\treturn '<b>'+ this.series.name +'</b><br/>'+","\t\t\t\tthis.x +': '+ this.y;","\t\t\t}","\t\t},","\t\tlegend: {","\t\t\tlayout: 'vertical',","\t\t\tstyle: {","\t\t\t\tleft: 'auto',","\t\t\t\tbottom: 'auto',","\t\t\t\tright: '10px',","\t\t\t\ttop: '100px'","\t\t\t}","\t\t},","\t\tcredits: {","\t\t\tenabled: false","\t\t},","\t\tseries: [","\t\t\t{","\t\t\t\tname: 'Subtotal',","\t\t\t\tdata: [","\t\t\t\t\t<%= subtotals.join(\",\") %>","\t\t\t\t]","\t\t\t},","\t\t\t{","\t\t\t\tname: 'Tax',","\t\t\t\tdata: [","\t\t\t\t\t<%= taxes.join(\",\") %>","\t\t\t\t]","\t\t\t},","\t\t\t{","\t\t\t\tname: 'Total',","\t\t\t\tdata: [","\t\t\t\t\t<%= totals.join(\",\") %>","\t\t\t\t]","\t\t\t}","\t\t]","\t});","});","</script>",""],"id":4}],[{"start":{"row":11,"column":2},"end":{"row":11,"column":48},"action":"remove","lines":["<%= link_to @company.name, @company %> &raquo;"],"id":5}],[{"start":{"row":10,"column":2},"end":{"row":10,"column":53},"action":"remove","lines":["<%= link_to \"My companies\", \"/companies\" %> &raquo;"],"id":6}],[{"start":{"row":12,"column":2},"end":{"row":12,"column":71},"action":"remove","lines":["<%= link_to \"Reports\", \"/companies/reports/#{@company.id}\" %> &raquo;"],"id":7}],[{"start":{"row":10,"column":2},"end":{"row":11,"column":2},"action":"remove","lines":["","  "],"id":8}]]},"ace":{"folds":[],"scrolltop":71,"scrollleft":0,"selection":{"start":{"row":32,"column":2},"end":{"row":32,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1500916007817}